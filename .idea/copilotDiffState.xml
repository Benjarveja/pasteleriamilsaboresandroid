<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/PasteleriaApp.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/PasteleriaApp.kt" />
              <option name="originalContent" value="package com.example.pasteleriamilssaboresandroid&#10;&#10;import android.app.Application&#10;import com.example.pasteleriamilssaboresandroid.data.database.AppDatabase&#10;import com.example.pasteleriamilssaboresandroid.data.database.order.OrderRepository&#10;import com.example.pasteleriamilssaboresandroid.data.database.user.UserRepository&#10;&#10;import com.example.pasteleriamilssaboresandroid.data.repository.CartRepository&#10;import com.example.pasteleriamilssaboresandroid.data.storage.CartStorage&#10;&#10;class PasteleriaApp : Application() {&#10;    val database by lazy { AppDatabase.getDatabase(this) }&#10;    val userRepository by lazy { UserRepository(database.userDao()) }&#10;    val orderRepository by lazy { OrderRepository(database.orderDao()) }&#10;    val cartRepository by lazy { CartRepository(CartStorage(this)) }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid&#10;&#10;import android.app.Application&#10;import com.example.pasteleriamilssaboresandroid.data.database.AppDatabase&#10;import com.example.pasteleriamilssaboresandroid.data.database.order.OrderRepository&#10;import com.example.pasteleriamilssaboresandroid.data.database.user.UserRepository&#10;import com.example.pasteleriamilssaboresandroid.data.network.RetrofitClient&#10;import com.example.pasteleriamilssaboresandroid.data.repository.CartRepository&#10;import com.example.pasteleriamilssaboresandroid.data.repository.NetworkProductRepository&#10;import com.example.pasteleriamilssaboresandroid.data.repository.ProductRepository&#10;import com.example.pasteleriamilssaboresandroid.data.storage.CartStorage&#10;&#10;class PasteleriaApp : Application() {&#10;    val database by lazy { AppDatabase.getDatabase(this) }&#10;    val userRepository by lazy { UserRepository(database.userDao()) }&#10;    val orderRepository by lazy { OrderRepository(database.orderDao()) }&#10;    val cartRepository by lazy { CartRepository(CartStorage(this)) }&#10;    val productRepository: ProductRepository by lazy {&#10;        NetworkProductRepository(RetrofitClient.instance)&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/ApiService.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/ApiService.kt" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.data.network&#10;&#10;import com.example.pasteleriamilssaboresandroid.data.network.dto.ProductResponse&#10;import retrofit2.http.GET&#10;import retrofit2.http.Path&#10;&#10;interface ApiService {&#10;    @GET(&quot;api/products&quot;)&#10;    suspend fun getProducts(): List&lt;ProductResponse&gt;&#10;&#10;    @GET(&quot;api/products/{codigo}&quot;)&#10;    suspend fun getProductByCodigo(@Path(&quot;codigo&quot;) codigo: String): ProductResponse&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/Mappers.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/Mappers.kt" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.data.network&#10;&#10;import com.example.pasteleriamilssaboresandroid.data.network.dto.ProductResponse&#10;import com.example.pasteleriamilssaboresandroid.domain.model.Product&#10;&#10;fun ProductResponse.toDomain(): Product {&#10;    return Product(&#10;        productId = this.codigo,&#10;        productName = this.nombre,&#10;        price = this.precio,&#10;        category = this.categoria,&#10;        productImage = this.imagenUrl,&#10;        productDescription = this.descripcion,&#10;        popular = this.popular,&#10;        history = this.historia&#10;    )&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/RetrofitClient.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/RetrofitClient.kt" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.data.network&#10;&#10;import retrofit2.Retrofit&#10;import retrofit2.converter.gson.GsonConverterFactory&#10;&#10;object RetrofitClient {&#10;    private const val BASE_URL = &quot;http://10.0.2.2:8080/&quot;&#10;&#10;    val instance: ApiService by lazy {&#10;        val retrofit = Retrofit.Builder()&#10;            .baseUrl(BASE_URL)&#10;            .addConverterFactory(GsonConverterFactory.create())&#10;            .build()&#10;        retrofit.create(ApiService::class.java)&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/dto/ProductResponse.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/network/dto/ProductResponse.kt" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.data.network.dto&#10;&#10;data class ProductResponse(&#10;    val codigo: String,&#10;    val categoria: String,&#10;    val nombre: String,&#10;    val precio: Int,&#10;    val descripcion: String,&#10;    val popular: Boolean,&#10;    val historia: String,&#10;    val imagenUrl: String&#10;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/repository/NetworkProductRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/data/repository/NetworkProductRepository.kt" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.data.repository&#10;&#10;import com.example.pasteleriamilssaboresandroid.data.network.ApiService&#10;import com.example.pasteleriamilssaboresandroid.data.network.toDomain&#10;import com.example.pasteleriamilssaboresandroid.domain.model.Product&#10;&#10;class NetworkProductRepository(private val apiService: ApiService) : ProductRepository {&#10;    override suspend fun getProducts(): List&lt;Product&gt; {&#10;        return apiService.getProducts().map { it.toDomain() }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/navigation/AppNavHost.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/navigation/AppNavHost.kt" />
              <option name="originalContent" value="package com.example.pasteleriamilssaboresandroid.navigation&#10;&#10;import android.net.Uri&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.List&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material.icons.filled.Info&#10;import androidx.compose.material.icons.filled.Person&#10;import androidx.compose.material.icons.filled.ShoppingCart&#10;import androidx.compose.material3.Badge&#10;import androidx.compose.material3.BadgedBox&#10;import androidx.compose.material3.CenterAlignedTopAppBar&#10;import androidx.compose.material3.DropdownMenu&#10;import androidx.compose.material3.DropdownMenuItem&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.SnackbarHost&#10;import androidx.compose.material3.SnackbarHostState&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import androidx.navigation.NavDestination.Companion.hierarchy&#10;import androidx.navigation.NavGraph.Companion.findStartDestination&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import coil.compose.rememberAsyncImagePainter&#10;import com.example.pasteleriamilssaboresandroid.PasteleriaApp&#10;import com.example.pasteleriamilssaboresandroid.data.repository.AssetsProductRepository&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.OrderConfirmationScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.ProcessingOrderScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.news.NewsScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductDetailScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductsScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.LoginScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.OrdersScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.ProfileScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.RegisterScreen&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.LoginResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.OrdersViewModel&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.OrdersViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.RegisterResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UpdateResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UserViewModel&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UserViewModelFactory&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun AppNavHost(startDestination: String = Screen.Home.route) {&#10;    val navController = rememberNavController()&#10;    val context = LocalContext.current&#10;    val application = context.applicationContext as PasteleriaApp&#10;&#10;    val cartVM: CartViewModel = viewModel(factory = CartViewModelFactory(application.cartRepository))&#10;    val userVM: UserViewModel = viewModel(factory = UserViewModelFactory(application.userRepository))&#10;    val checkoutVM: CheckoutViewModel = viewModel(factory = CheckoutViewModelFactory(application.orderRepository))&#10;    val ordersVM: OrdersViewModel = viewModel(factory = OrdersViewModelFactory(application.orderRepository))&#10;    val homeVM: HomeViewModel = viewModel(factory = HomeViewModelFactory(AssetsProductRepository(context.assets)))&#10;&#10;    val cartUi by cartVM.ui.collectAsStateWithLifecycle()&#10;    val loginResult by userVM.loginResult.collectAsStateWithLifecycle()&#10;    val registerResult by userVM.registerResult.collectAsStateWithLifecycle()&#10;    val updateResult by userVM.updateResult.collectAsStateWithLifecycle()&#10;    val loggedInUser by userVM.loggedInUser.collectAsStateWithLifecycle()&#10;    val checkoutUi by checkoutVM.uiState.collectAsStateWithLifecycle()&#10;&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    var showMenu by remember { mutableStateOf(false) }&#10;&#10;    val items = listOf(&#10;        BottomItem(Screen.Home.route, &quot;Inicio&quot;, Icons.Filled.Home),&#10;        BottomItem(Screen.Products.route, &quot;Productos&quot;, Icons.AutoMirrored.Filled.List),&#10;        BottomItem(Screen.News.route, &quot;Noticias&quot;, Icons.Filled.Info),&#10;        BottomItem(Screen.Cart.route, &quot;Carrito&quot;, Icons.Filled.ShoppingCart),&#10;    )&#10;&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentDestination = navBackStackEntry?.destination&#10;    val showBottomBar = currentDestination?.route !in listOf(&#10;        Screen.LoginFlow.route, &#10;        Screen.Register.route, &#10;        Screen.Checkout.route, &#10;        &quot;order_confirmation&quot;,&#10;        &quot;processing_order&quot;&#10;    )&#10;&#10;    LaunchedEffect(checkoutUi.order) {&#10;        if (checkoutUi.order != null) {&#10;            navController.navigate(&quot;order_confirmation&quot;)&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        snackbarHost = { SnackbarHost(hostState = snackbarHostState) },&#10;        topBar = {&#10;            if (showBottomBar) {&#10;                CenterAlignedTopAppBar(&#10;                    title = { Text(text = &quot;Pastelería MilSabores&quot;) },&#10;                    colors = TopAppBarDefaults.centerAlignedTopAppBarColors(&#10;                        containerColor = MaterialTheme.colorScheme.tertiary&#10;                    ),&#10;                    actions = {&#10;                        if (loggedInUser == null) {&#10;                            IconButton(onClick = { navController.navigate(Screen.LoginFlow.route) }) {&#10;                                Icon(Icons.Filled.Person, contentDescription = &quot;Login&quot;)&#10;                            }&#10;                        } else {&#10;                            Box {&#10;                                IconButton(onClick = { showMenu = !showMenu }) {&#10;                                    loggedInUser?.profilePictureUri?.let { uriString -&gt;&#10;                                        Image(&#10;                                            painter = rememberAsyncImagePainter(model = Uri.parse(uriString)),&#10;                                            contentDescription = &quot;User Profile Picture&quot;,&#10;                                            modifier = Modifier&#10;                                                .size(32.dp)&#10;                                                .clip(CircleShape),&#10;                                            contentScale = ContentScale.Crop&#10;                                        )&#10;                                    } ?: Icon(Icons.Filled.Person, contentDescription = &quot;User Menu&quot;)&#10;                                }&#10;                                DropdownMenu(&#10;                                    expanded = showMenu,&#10;                                    onDismissRequest = { showMenu = false }&#10;                                ) {&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Administrar Perfil&quot;) },&#10;                                        onClick = {&#10;                                            navController.navigate(Screen.Profile.route)&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Ver Pedidos&quot;) },&#10;                                        onClick = {&#10;                                            navController.navigate(Screen.Orders.route)&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Cerrar Sesión&quot;) },&#10;                                        onClick = {&#10;                                            userVM.logout()&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        },&#10;        bottomBar = {&#10;            if (showBottomBar) {&#10;                NavigationBar {&#10;                    items.forEach { item -&gt;&#10;                        val selected = currentDestination?.hierarchy?.any { it.route == item.route } == true&#10;                        NavigationBarItem(&#10;                            icon = {&#10;                                if (item.route == Screen.Cart.route) {&#10;                                    BadgedBox(&#10;                                        badge = {&#10;                                            if (cartUi.itemCount &gt; 0) {&#10;                                                Badge { Text(&quot;${cartUi.itemCount}&quot;) }&#10;                                            }&#10;                                        }&#10;                                    ) {&#10;                                        Icon(imageVector = item.icon, contentDescription = item.label)&#10;                                    }&#10;                                } else {&#10;                                    Icon(imageVector = item.icon, contentDescription = item.label)&#10;                                }&#10;                            },&#10;                            label = { Text(item.label) },&#10;                            selected = selected,&#10;                            onClick = {&#10;                                if (!selected) navController.navigate(item.route) {&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                    popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                }&#10;                            }&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    ) { innerPadding -&gt;&#10;        Box(modifier = Modifier.padding(innerPadding)) {&#10;            NavHost(navController = navController, startDestination = startDestination) {&#10;                composable(Screen.Home.route) {&#10;                    HomeScreen(homeViewModel = homeVM, onLoginClick = { navController.navigate(Screen.LoginFlow.route) })&#10;                }&#10;                composable(Screen.LoginFlow.route) {&#10;                    LoginScreen(&#10;                        onLoginClick = { email, password -&gt; userVM.login(email, password) },&#10;                        onContinueAsGuestClick = { navController.popBackStack() },&#10;                        onRegisterClick = { navController.navigate(Screen.Register.route) },&#10;                        onBackClick = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Register.route) {&#10;                    RegisterScreen(&#10;                        onRegisterClick = { firstName, lastName, email, password, phone, run, birthDate, region, comuna, street -&gt;&#10;                            userVM.registerUser(firstName, lastName, email, password, phone, run, birthDate, region, comuna, street)&#10;                        },&#10;                        onBackClick = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Products.route) {&#10;                    ProductsScreen(&#10;                        cartVM = cartVM,&#10;                        onOpen = { id -&gt; navController.navigate(&quot;product/$id&quot;) },&#10;                        onShowSnackbar = { message -&gt;&#10;                            scope.launch { snackbarHostState.showSnackbar(message) }&#10;                        }&#10;                    )&#10;                }&#10;                composable(Screen.News.route) { NewsScreen() }&#10;                composable(Screen.Cart.route) {&#10;                    CartScreen(&#10;                        cartVM = cartVM,&#10;                        onCheckout = { navController.navigate(Screen.Checkout.route) }&#10;                    )&#10;                }&#10;                composable(Screen.Checkout.route) {&#10;                    if (checkoutUi.isLoading) {&#10;                        ProcessingOrderScreen()&#10;                    } else {&#10;                        CheckoutScreen(&#10;                            cartVM = cartVM,&#10;                            userVM = userVM,&#10;                            checkoutVM = checkoutVM,&#10;                            onFinish = {&#10;                                checkoutVM.processOrder(cartUi.items, loggedInUser)&#10;                            },&#10;                            onBack = { navController.popBackStack() }&#10;                        )&#10;                    }&#10;                }&#10;                composable(&quot;order_confirmation&quot;) { &#10;                    checkoutUi.order?.let {&#10;                        OrderConfirmationScreen(order = it) {&#10;                            cartVM.clear()&#10;                            navController.navigate(Screen.Home.route) {&#10;                                popUpTo(navController.graph.findStartDestination().id) {&#10;                                    inclusive = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;                composable(Screen.ProductDetail.route) { backStackEntry -&gt;&#10;                    val id = backStackEntry.arguments?.getString(Screen.ProductDetail.ID) ?: &quot;&quot;&#10;                    ProductDetailScreen(&#10;                        productId = id,&#10;                        cartVM = cartVM,&#10;                        onBack = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Profile.route) {&#10;                    ProfileScreen(userViewModel = userVM)&#10;                }&#10;                composable(Screen.Orders.route) {&#10;                    OrdersScreen(ordersViewModel = ordersVM, userViewModel = userVM)&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(loggedInUser, currentDestination) {&#10;        if (loggedInUser == null) {&#10;            val protectedRoutes = listOf(Screen.Profile.route, Screen.Orders.route)&#10;            if (currentDestination?.route in protectedRoutes) {&#10;                navController.navigate(Screen.Home.route) {&#10;                    popUpTo(navController.graph.findStartDestination().id) {&#10;                        inclusive = true&#10;                    }&#10;                    launchSingleTop = true&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(loginResult) {&#10;        when (val result = loginResult) {&#10;            is LoginResult.Success -&gt; {&#10;                navController.popBackStack()&#10;                userVM.resetLoginState()&#10;            }&#10;            is LoginResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetLoginState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(registerResult) {&#10;        when (val result = registerResult) {&#10;            is RegisterResult.Success -&gt; {&#10;                navController.popBackStack()&#10;                userVM.resetRegisterState()&#10;            }&#10;            is RegisterResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetRegisterState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(updateResult) {&#10;        when (val result = updateResult) {&#10;            is UpdateResult.Success -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(&quot;Perfil actualizado correctamente&quot;) }&#10;                userVM.resetUpdateState()&#10;            }&#10;            is UpdateResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetUpdateState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.navigation&#10;&#10;import android.net.Uri&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.List&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material.icons.filled.Info&#10;import androidx.compose.material.icons.filled.Person&#10;import androidx.compose.material.icons.filled.ShoppingCart&#10;import androidx.compose.material3.Badge&#10;import androidx.compose.material3.BadgedBox&#10;import androidx.compose.material3.CenterAlignedTopAppBar&#10;import androidx.compose.material3.DropdownMenu&#10;import androidx.compose.material3.DropdownMenuItem&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.SnackbarHost&#10;import androidx.compose.material3.SnackbarHostState&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import androidx.navigation.NavDestination.Companion.hierarchy&#10;import androidx.navigation.NavGraph.Companion.findStartDestination&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import coil.compose.rememberAsyncImagePainter&#10;import com.example.pasteleriamilssaboresandroid.PasteleriaApp&#10;import com.example.pasteleriamilssaboresandroid.data.repository.AssetsProductRepository&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.CheckoutViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.OrderConfirmationScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.checkout.ProcessingOrderScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.news.NewsScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductDetailScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductsScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductsViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.products.ProductsViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeViewModel&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.home.HomeViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.LoginScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.OrdersScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.ProfileScreen&#10;import com.example.pasteleriamilssaboresandroid.ui.theme.screen.user.RegisterScreen&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.LoginResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.OrdersViewModel&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.OrdersViewModelFactory&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.RegisterResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UpdateResult&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UserViewModel&#10;import com.example.pasteleriamilssaboresandroid.viewmodel.UserViewModelFactory&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun AppNavHost(startDestination: String = Screen.Home.route) {&#10;    val navController = rememberNavController()&#10;    val context = LocalContext.current&#10;    val application = context.applicationContext as PasteleriaApp&#10;&#10;    val cartVM: CartViewModel = viewModel(factory = CartViewModelFactory(application.cartRepository))&#10;    val userVM: UserViewModel = viewModel(factory = UserViewModelFactory(application.userRepository))&#10;    val checkoutVM: CheckoutViewModel = viewModel(factory = CheckoutViewModelFactory(application.orderRepository))&#10;    val ordersVM: OrdersViewModel = viewModel(factory = OrdersViewModelFactory(application.orderRepository))&#10;    val homeVM: HomeViewModel = viewModel(factory = HomeViewModelFactory(application.productRepository))&#10;    val productsVM: ProductsViewModel = viewModel(factory = ProductsViewModelFactory(application.productRepository))&#10;&#10;    val cartUi by cartVM.ui.collectAsStateWithLifecycle()&#10;    val loginResult by userVM.loginResult.collectAsStateWithLifecycle()&#10;    val registerResult by userVM.registerResult.collectAsStateWithLifecycle()&#10;    val updateResult by userVM.updateResult.collectAsStateWithLifecycle()&#10;    val loggedInUser by userVM.loggedInUser.collectAsStateWithLifecycle()&#10;    val checkoutUi by checkoutVM.uiState.collectAsStateWithLifecycle()&#10;&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    var showMenu by remember { mutableStateOf(false) }&#10;&#10;    val items = listOf(&#10;        BottomItem(Screen.Home.route, &quot;Inicio&quot;, Icons.Filled.Home),&#10;        BottomItem(Screen.Products.route, &quot;Productos&quot;, Icons.AutoMirrored.Filled.List),&#10;        BottomItem(Screen.News.route, &quot;Noticias&quot;, Icons.Filled.Info),&#10;        BottomItem(Screen.Cart.route, &quot;Carrito&quot;, Icons.Filled.ShoppingCart),&#10;    )&#10;&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentDestination = navBackStackEntry?.destination&#10;    val showBottomBar = currentDestination?.route !in listOf(&#10;        Screen.LoginFlow.route, &#10;        Screen.Register.route, &#10;        Screen.Checkout.route, &#10;        &quot;order_confirmation&quot;,&#10;        &quot;processing_order&quot;&#10;    )&#10;&#10;    LaunchedEffect(checkoutUi.order) {&#10;        if (checkoutUi.order != null) {&#10;            navController.navigate(&quot;order_confirmation&quot;)&#10;        }&#10;    }&#10;&#10;    Scaffold(&#10;        snackbarHost = { SnackbarHost(hostState = snackbarHostState) },&#10;        topBar = {&#10;            if (showBottomBar) {&#10;                CenterAlignedTopAppBar(&#10;                    title = { Text(text = &quot;Pastelería MilSabores&quot;) },&#10;                    colors = TopAppBarDefaults.centerAlignedTopAppBarColors(&#10;                        containerColor = MaterialTheme.colorScheme.tertiary&#10;                    ),&#10;                    actions = {&#10;                        if (loggedInUser == null) {&#10;                            IconButton(onClick = { navController.navigate(Screen.LoginFlow.route) }) {&#10;                                Icon(Icons.Filled.Person, contentDescription = &quot;Login&quot;)&#10;                            }&#10;                        } else {&#10;                            Box {&#10;                                IconButton(onClick = { showMenu = !showMenu }) {&#10;                                    loggedInUser?.profilePictureUri?.let { uriString -&gt;&#10;                                        Image(&#10;                                            painter = rememberAsyncImagePainter(model = Uri.parse(uriString)),&#10;                                            contentDescription = &quot;User Profile Picture&quot;,&#10;                                            modifier = Modifier&#10;                                                .size(32.dp)&#10;                                                .clip(CircleShape),&#10;                                            contentScale = ContentScale.Crop&#10;                                        )&#10;                                    } ?: Icon(Icons.Filled.Person, contentDescription = &quot;User Menu&quot;)&#10;                                }&#10;                                DropdownMenu(&#10;                                    expanded = showMenu,&#10;                                    onDismissRequest = { showMenu = false }&#10;                                ) {&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Administrar Perfil&quot;) },&#10;                                        onClick = {&#10;                                            navController.navigate(Screen.Profile.route)&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Ver Pedidos&quot;) },&#10;                                        onClick = {&#10;                                            navController.navigate(Screen.Orders.route)&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                    DropdownMenuItem(&#10;                                        text = { Text(&quot;Cerrar Sesión&quot;) },&#10;                                        onClick = {&#10;                                            userVM.logout()&#10;                                            showMenu = false&#10;                                        }&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        },&#10;        bottomBar = {&#10;            if (showBottomBar) {&#10;                NavigationBar {&#10;                    items.forEach { item -&gt;&#10;                        val selected = currentDestination?.hierarchy?.any { it.route == item.route } == true&#10;                        NavigationBarItem(&#10;                            icon = {&#10;                                if (item.route == Screen.Cart.route) {&#10;                                    BadgedBox(&#10;                                        badge = {&#10;                                            if (cartUi.itemCount &gt; 0) {&#10;                                                Badge { Text(&quot;${cartUi.itemCount}&quot;) }&#10;                                            }&#10;                                        }&#10;                                    ) {&#10;                                        Icon(imageVector = item.icon, contentDescription = item.label)&#10;                                    }&#10;                                } else {&#10;                                    Icon(imageVector = item.icon, contentDescription = item.label)&#10;                                }&#10;                            },&#10;                            label = { Text(item.label) },&#10;                            selected = selected,&#10;                            onClick = {&#10;                                if (!selected) navController.navigate(item.route) {&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                    popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                }&#10;                            }&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    ) { innerPadding -&gt;&#10;        Box(modifier = Modifier.padding(innerPadding)) {&#10;            NavHost(navController = navController, startDestination = startDestination) {&#10;                composable(Screen.Home.route) {&#10;                    HomeScreen(homeViewModel = homeVM, onLoginClick = { navController.navigate(Screen.LoginFlow.route) })&#10;                }&#10;                composable(Screen.LoginFlow.route) {&#10;                    LoginScreen(&#10;                        onLoginClick = { email, password -&gt; userVM.login(email, password) },&#10;                        onContinueAsGuestClick = { navController.popBackStack() },&#10;                        onRegisterClick = { navController.navigate(Screen.Register.route) },&#10;                        onBackClick = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Register.route) {&#10;                    RegisterScreen(&#10;                        onRegisterClick = { firstName, lastName, email, password, phone, run, birthDate, region, comuna, street -&gt;&#10;                            userVM.registerUser(firstName, lastName, email, password, phone, run, birthDate, region, comuna, street)&#10;                        },&#10;                        onBackClick = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Products.route) {&#10;                    ProductsScreen(&#10;                        productsVM = productsVM,&#10;                        cartVM = cartVM,&#10;                        onOpen = { id -&gt; navController.navigate(&quot;product/$id&quot;) },&#10;                        onShowSnackbar = { message -&gt;&#10;                            scope.launch { snackbarHostState.showSnackbar(message) }&#10;                        }&#10;                    )&#10;                }&#10;                composable(Screen.News.route) { NewsScreen() }&#10;                composable(Screen.Cart.route) {&#10;                    CartScreen(&#10;                        cartVM = cartVM,&#10;                        onCheckout = { navController.navigate(Screen.Checkout.route) }&#10;                    )&#10;                }&#10;                composable(Screen.Checkout.route) {&#10;                    if (checkoutUi.isLoading) {&#10;                        ProcessingOrderScreen()&#10;                    } else {&#10;                        CheckoutScreen(&#10;                            cartVM = cartVM,&#10;                            userVM = userVM,&#10;                            checkoutVM = checkoutVM,&#10;                            onFinish = {&#10;                                checkoutVM.processOrder(cartUi.items, loggedInUser)&#10;                            },&#10;                            onBack = { navController.popBackStack() }&#10;                        )&#10;                    }&#10;                }&#10;                composable(&quot;order_confirmation&quot;) { &#10;                    checkoutUi.order?.let {&#10;                        OrderConfirmationScreen(order = it) {&#10;                            cartVM.clear()&#10;                            navController.navigate(Screen.Home.route) {&#10;                                popUpTo(navController.graph.findStartDestination().id) {&#10;                                    inclusive = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;                composable(Screen.ProductDetail.route) { backStackEntry -&gt;&#10;                    val id = backStackEntry.arguments?.getString(Screen.ProductDetail.ID) ?: &quot;&quot;&#10;                    ProductDetailScreen(&#10;                        productsVM = productsVM,&#10;                        productId = id,&#10;                        cartVM = cartVM,&#10;                        onBack = { navController.popBackStack() }&#10;                    )&#10;                }&#10;                composable(Screen.Profile.route) {&#10;                    ProfileScreen(userViewModel = userVM)&#10;                }&#10;                composable(Screen.Orders.route) {&#10;                    OrdersScreen(ordersViewModel = ordersVM, userViewModel = userVM)&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(loggedInUser, currentDestination) {&#10;        if (loggedInUser == null) {&#10;            val protectedRoutes = listOf(Screen.Profile.route, Screen.Orders.route)&#10;            if (currentDestination?.route in protectedRoutes) {&#10;                navController.navigate(Screen.Home.route) {&#10;                    popUpTo(navController.graph.findStartDestination().id) {&#10;                        inclusive = true&#10;                    }&#10;                    launchSingleTop = true&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(loginResult) {&#10;        when (val result = loginResult) {&#10;            is LoginResult.Success -&gt; {&#10;                navController.popBackStack()&#10;                userVM.resetLoginState()&#10;            }&#10;            is LoginResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetLoginState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(registerResult) {&#10;        when (val result = registerResult) {&#10;            is RegisterResult.Success -&gt; {&#10;                navController.popBackStack()&#10;                userVM.resetRegisterState()&#10;            }&#10;            is RegisterResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetRegisterState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;&#10;    LaunchedEffect(updateResult) {&#10;        when (val result = updateResult) {&#10;            is UpdateResult.Success -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(&quot;Perfil actualizado correctamente&quot;) }&#10;                userVM.resetUpdateState()&#10;            }&#10;            is UpdateResult.Error -&gt; {&#10;                scope.launch { snackbarHostState.showSnackbar(result.message) }&#10;                userVM.resetUpdateState()&#10;            }&#10;            else -&gt; {}&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/ui/products/ProductsScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pasteleriamilssaboresandroid/ui/products/ProductsScreen.kt" />
              <option name="originalContent" value="package com.example.pasteleriamilssaboresandroid.ui.products&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.horizontalScroll&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.FilterChip&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.OutlinedButton&#10;import androidx.compose.material3.OutlinedTextField&#10;import androidx.compose.material3.RangeSlider&#10;import androidx.compose.material3.SliderDefaults&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.rememberAsyncImagePainter&#10;import coil.request.ImageRequest&#10;import com.example.pasteleriamilssaboresandroid.data.repository.AssetsProductRepository&#10;import com.example.pasteleriamilssaboresandroid.domain.model.Product&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModel&#10;import com.example.pasteleriamilssaboresandroid.util.formatCLP&#10;import kotlin.math.roundToInt&#10;&#10;@Composable&#10;fun ProductsScreen(cartVM: CartViewModel, onOpen: (String) -&gt; Unit, onShowSnackbar: (String) -&gt; Unit) {&#10;    val context = LocalContext.current&#10;    val vm: ProductsViewModel = viewModel(&#10;        factory = ProductsViewModelFactory(AssetsProductRepository(context.assets))&#10;    )&#10;    val ui by vm.uiState.collectAsStateWithLifecycle()&#10;&#10;    Column(modifier = Modifier.fillMaxSize().padding(16.dp)) {&#10;        Text(&#10;            text = &quot;Productos&quot;,&#10;            style = MaterialTheme.typography.headlineMedium,&#10;            fontWeight = FontWeight.Bold&#10;        )&#10;        OutlinedTextField(&#10;            value = ui.query,&#10;            onValueChange = vm::onQueryChange,&#10;            modifier = Modifier.fillMaxWidth().padding(top = 12.dp),&#10;            label = { Text(&quot;Buscar productos&quot;) }&#10;        )&#10;&#10;        // Botón para mostrar/ocultar filtros&#10;        Button(&#10;            onClick = { vm.toggleFilters() },&#10;            modifier = Modifier.padding(top = 8.dp)&#10;        ) {&#10;            Text(if (ui.filtersVisible) &quot;Ocultar filtros&quot; else &quot;Mostrar filtros&quot;)&#10;        }&#10;&#10;        // Filtros&#10;        if (ui.filtersVisible &amp;&amp; !ui.isLoading &amp;&amp; ui.products.isNotEmpty()) {&#10;            Text(&#10;                text = &quot;Filtros&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;            )&#10;            // Categorías&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth().horizontalScroll(rememberScrollState()),&#10;                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                FilterChip(&#10;                    selected = ui.category == null,&#10;                    onClick = { vm.onCategoryChange(null) },&#10;                    label = { Text(&quot;Todas&quot;) }&#10;                )&#10;                ui.categories.forEach { cat -&gt;&#10;                    FilterChip(&#10;                        selected = ui.category == cat,&#10;                        onClick = { vm.onCategoryChange(if (ui.category == cat) null else cat) },&#10;                        label = { Text(cat) }&#10;                    )&#10;                }&#10;            }&#10;            // Rango de precios&#10;            val min = ui.minPrice&#10;            val max = ui.maxPrice&#10;            if (max &gt; min) {&#10;                Column(Modifier.padding(top = 12.dp)) {&#10;                    Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceBetween) {&#10;                        Text(formatCLP(ui.selectedMinPrice))&#10;                        Text(formatCLP(ui.selectedMaxPrice))&#10;                    }&#10;                    RangeSlider(&#10;                        value = ui.selectedMinPrice.toFloat()..ui.selectedMaxPrice.toFloat(),&#10;                        onValueChange = { range -&gt;&#10;                            vm.onPriceRangeChange(range.start.roundToInt(), range.endInclusive.roundToInt())&#10;                        },&#10;                        valueRange = min.toFloat()..max.toFloat(),&#10;                        colors = SliderDefaults.colors()&#10;                    )&#10;                    Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End) {&#10;                        OutlinedButton(onClick = { vm.resetFilters() }) { Text(&quot;Restablecer filtros&quot;) }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        when {&#10;            ui.isLoading -&gt; Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {&#10;                CircularProgressIndicator()&#10;            }&#10;            ui.error != null -&gt; Column(&#10;                modifier = Modifier.fillMaxSize(),&#10;                verticalArrangement = Arrangement.Center,&#10;                horizontalAlignment = Alignment.CenterHorizontally&#10;            ) {&#10;                Text(&quot;Ocurrió un error: ${ui.error}&quot;)&#10;                Button(onClick = { vm.load() }, modifier = Modifier.padding(top = 8.dp)) {&#10;                    Text(&quot;Reintentar&quot;)&#10;                }&#10;            }&#10;            else -&gt; ProductList(&#10;                products = vm.filtered(ui),&#10;                onAdd = {&#10;                    cartVM.add(it)&#10;                    onShowSnackbar(&quot;${it.name} agregado al carrito&quot;)&#10;                },&#10;                onOpen = onOpen&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ProductList(products: List&lt;Product&gt;, onAdd: (Product) -&gt; Unit, onOpen: (String) -&gt; Unit) {&#10;    if (products.isEmpty()) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {&#10;            Text(&quot;No hay productos que coincidan&quot;)&#10;        }&#10;        return&#10;    }&#10;    LazyColumn(&#10;        modifier = Modifier.fillMaxSize().padding(top = 12.dp),&#10;        contentPadding = PaddingValues(bottom = 24.dp),&#10;        verticalArrangement = Arrangement.spacedBy(12.dp)&#10;    ) {&#10;        items(products, key = { it.id }) { p -&gt; ProductItem(p, onAdd, onOpen) }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ProductItem(p: Product, onAdd: (Product) -&gt; Unit, onOpen: (String) -&gt; Unit) {&#10;    val context = LocalContext.current&#10;    val assetPath = p.image?.let { &quot;file:///android_asset/$it&quot; }&#10;    val painter = rememberAsyncImagePainter(&#10;        model = ImageRequest.Builder(context)&#10;            .data(assetPath)&#10;            .crossfade(true)&#10;            .build()&#10;    )&#10;&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.tertiary)&#10;    ) {&#10;        Row(modifier = Modifier.fillMaxWidth().padding(16.dp), verticalAlignment = Alignment.CenterVertically) {&#10;            if (assetPath != null) {&#10;                Image(&#10;                    painter = painter,&#10;                    contentDescription = p.name,&#10;                    modifier = Modifier.size(64.dp).clip(MaterialTheme.shapes.small)&#10;                )&#10;                Spacer(Modifier.size(12.dp))&#10;            }&#10;            Column(Modifier.weight(1f)) {&#10;                Text(text = p.name, style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.SemiBold)&#10;                Text(text = p.category, style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.secondary)&#10;                Spacer(Modifier.size(8.dp))&#10;                Column(verticalArrangement = Arrangement.spacedBy(4.dp)) {&#10;                    OutlinedButton(onClick = { onAdd(p) }) { Text(&quot;Agregar al carrito&quot;) }&#10;                    TextButton(onClick = { onOpen(p.id) }) { Text(&quot;Ver detalle&quot;) }&#10;                }&#10;            }&#10;            Text(text = formatCLP(p.price), style = MaterialTheme.typography.titleMedium)&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.pasteleriamilssaboresandroid.ui.products&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.horizontalScroll&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.FilterChip&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.OutlinedButton&#10;import androidx.compose.material3.OutlinedTextField&#10;import androidx.compose.material3.RangeSlider&#10;import androidx.compose.material3.SliderDefaults&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.lifecycle.viewmodel.compose.viewModel&#10;import coil.compose.rememberAsyncImagePainter&#10;import coil.request.ImageRequest&#10;import com.example.pasteleriamilssaboresandroid.data.repository.AssetsProductRepository&#10;import com.example.pasteleriamilssaboresandroid.domain.model.Product&#10;import com.example.pasteleriamilssaboresandroid.ui.cart.CartViewModel&#10;import com.example.pasteleriamilssaboresandroid.util.formatCLP&#10;import kotlin.math.roundToInt&#10;&#10;@Composable&#10;fun ProductsScreen(&#10;    productsVM: ProductsViewModel,&#10;    cartVM: CartViewModel,&#10;    onOpen: (String) -&gt; Unit,&#10;    onShowSnackbar: (String) -&gt; Unit&#10;) {&#10;    val ui by productsVM.uiState.collectAsStateWithLifecycle()&#10;&#10;    Column(modifier = Modifier.fillMaxSize().padding(16.dp)) {&#10;        Text(&#10;            text = &quot;Productos&quot;,&#10;            style = MaterialTheme.typography.headlineMedium,&#10;            fontWeight = FontWeight.Bold&#10;        )&#10;        OutlinedTextField(&#10;            value = ui.query,&#10;            onValueChange = productsVM::onQueryChange,&#10;            modifier = Modifier.fillMaxWidth().padding(top = 12.dp),&#10;            label = { Text(&quot;Buscar productos&quot;) }&#10;        )&#10;&#10;        // Botón para mostrar/ocultar filtros&#10;        Button(&#10;            onClick = { productsVM.toggleFilters() },&#10;            modifier = Modifier.padding(top = 8.dp)&#10;        ) {&#10;            Text(if (ui.filtersVisible) &quot;Ocultar filtros&quot; else &quot;Mostrar filtros&quot;)&#10;        }&#10;&#10;        // Filtros&#10;        if (ui.filtersVisible &amp;&amp; !ui.isLoading &amp;&amp; ui.products.isNotEmpty()) {&#10;            Text(&#10;                text = &quot;Filtros&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;            )&#10;            // Categorías&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth().horizontalScroll(rememberScrollState()),&#10;                horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                FilterChip(&#10;                    selected = ui.category == null,&#10;                    onClick = { productsVM.onCategoryChange(null) },&#10;                    label = { Text(&quot;Todas&quot;) }&#10;                )&#10;                ui.categories.forEach { cat -&gt;&#10;                    FilterChip(&#10;                        selected = ui.category == cat,&#10;                        onClick = { productsVM.onCategoryChange(if (ui.category == cat) null else cat) },&#10;                        label = { Text(cat) }&#10;                    )&#10;                }&#10;            }&#10;            // Rango de precios&#10;            val min = ui.minPrice&#10;            val max = ui.maxPrice&#10;            if (max &gt; min) {&#10;                Column(Modifier.padding(top = 12.dp)) {&#10;                    Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceBetween) {&#10;                        Text(formatCLP(ui.selectedMinPrice))&#10;                        Text(formatCLP(ui.selectedMaxPrice))&#10;                    }&#10;                    RangeSlider(&#10;                        value = ui.selectedMinPrice.toFloat()..ui.selectedMaxPrice.toFloat(),&#10;                        onValueChange = { range -&gt;&#10;                            productsVM.onPriceRangeChange(range.start.roundToInt(), range.endInclusive.roundToInt())&#10;                        },&#10;                        valueRange = min.toFloat()..max.toFloat(),&#10;                        colors = SliderDefaults.colors()&#10;                    )&#10;                    Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End) {&#10;                        OutlinedButton(onClick = { productsVM.resetFilters() }) { Text(&quot;Restablecer filtros&quot;) }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        when {&#10;            ui.isLoading -&gt; Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {&#10;                CircularProgressIndicator()&#10;            }&#10;            ui.error != null -&gt; Column(&#10;                modifier = Modifier.fillMaxSize(),&#10;                verticalArrangement = Arrangement.Center,&#10;                horizontalAlignment = Alignment.CenterHorizontally&#10;            ) {&#10;                Text(&quot;Ocurrió un error: ${ui.error}&quot;)&#10;                Button(onClick = { productsVM.load() }, modifier = Modifier.padding(top = 8.dp)) {&#10;                    Text(&quot;Reintentar&quot;)&#10;                }&#10;            }&#10;            else -&gt; ProductList(&#10;                products = productsVM.filtered(ui),&#10;                onAdd = {&#10;                    cartVM.add(it)&#10;                    onShowSnackbar(&quot;${it.name} agregado al carrito&quot;)&#10;                },&#10;                onOpen = onOpen&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ProductList(products: List&lt;Product&gt;, onAdd: (Product) -&gt; Unit, onOpen: (String) -&gt; Unit) {&#10;    if (products.isEmpty()) {&#10;        Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {&#10;            Text(&quot;No hay productos que coincidan&quot;)&#10;        }&#10;        return&#10;    }&#10;    LazyColumn(&#10;        modifier = Modifier.fillMaxSize().padding(top = 12.dp),&#10;        contentPadding = PaddingValues(bottom = 24.dp),&#10;        verticalArrangement = Arrangement.spacedBy(12.dp)&#10;    ) {&#10;        items(products, key = { it.id }) { p -&gt; ProductItem(p, onAdd, onOpen) }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ProductItem(p: Product, onAdd: (Product) -&gt; Unit, onOpen: (String) -&gt; Unit) {&#10;    val context = LocalContext.current&#10;    val assetPath = p.image?.let { &quot;file:///android_asset/$it&quot; }&#10;    val painter = rememberAsyncImagePainter(&#10;        model = ImageRequest.Builder(context)&#10;            .data(assetPath)&#10;            .crossfade(true)&#10;            .build()&#10;    )&#10;&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.tertiary)&#10;    ) {&#10;        Row(modifier = Modifier.fillMaxWidth().padding(16.dp), verticalAlignment = Alignment.CenterVertically) {&#10;            if (assetPath != null) {&#10;                Image(&#10;                    painter = painter,&#10;                    contentDescription = p.name,&#10;                    modifier = Modifier.size(64.dp).clip(MaterialTheme.shapes.small)&#10;                )&#10;                Spacer(Modifier.size(12.dp))&#10;            }&#10;            Column(Modifier.weight(1f)) {&#10;                Text(text = p.name, style = MaterialTheme.typography.titleMedium, fontWeight = FontWeight.SemiBold)&#10;                Text(text = p.category, style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.secondary)&#10;                Spacer(Modifier.size(8.dp))&#10;                Column(verticalArrangement = Arrangement.spacedBy(4.dp)) {&#10;                    OutlinedButton(onClick = { onAdd(p) }) { Text(&quot;Agregar al carrito&quot;) }&#10;                    TextButton(onClick = { onOpen(p.id) }) { Text(&quot;Ver detalle&quot;) }&#10;                }&#10;            }&#10;            Text(text = formatCLP(p.price), style = MaterialTheme.typography.titleMedium)&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>